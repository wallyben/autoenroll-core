name: Move One File
on:
  workflow_dispatch:
    inputs:
      src:
        description: "Source path (e.g., server.js)"
        required: true
      dst:
        description: "Destination path (e.g., apps/orchestrator/_imported/server.js)"
        required: true
permissions:
  contents: write
jobs:
  mv:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with: { fetch-depth: 0 }
      - name: Validate and move
        run: |
          set -euo pipefail
          SRC="${{ github.event.inputs.src }}"
          DST="${{ github.event.inputs.dst }}"
          echo "SRC=$SRC  DST=$DST"
          if [ ! -e "$SRC" ]; then
            echo "ERROR: source '$SRC' not found"; exit 1;
          fi
          mkdir -p "$(dirname "$DST")"
          git mv "$SRC" "$DST"
          git commit -m "chore: move $SRC -> $DST" || { echo "No file changes"; exit 0; }
          git push origin HEAD:${GITHUB_REF_NAME}
