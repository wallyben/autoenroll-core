name: Move Directory
on:
  workflow_dispatch:
    inputs:
      src_dir:
        description: "Source directory (e.g., devcontainer or .devcontainer)"
        required: true
      dst_dir:
        description: "Destination directory (e.g., apps/orchestrator/_imported)"
        required: true
permissions:
  contents: write
jobs:
  mvdir:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with: { fetch-depth: 0 }
      - name: Validate and move
        run: |
          set -euo pipefail
          SRC="${{ github.event.inputs.src_dir }}"
          DST="${{ github.event.inputs.dst_dir }}"
          echo "SRC=$SRC  DST=$DST"
          if [ ! -d "$SRC" ]; then
            echo "ERROR: source dir '$SRC' not found at repo root"; exit 1;
          fi
          mkdir -p "$DST"
          git mv "$SRC" "$DST/"   # becomes $DST/<src_basename>
          git commit -m "chore: move dir $SRC -> $DST/" || { echo "No dir changes"; exit 0; }
          git push origin HEAD:${GITHUB_REF_NAME}
